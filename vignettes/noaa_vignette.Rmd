---
title: "noaa_vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{noaa_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(noaa) # load the package
```

## Load the Dataset
The source of the data is [NOAA](https://www.ngdc.noaa.gov/hazel/view/hazards/earthquake/event-data)
```{r load data}
data("eaq_data")
```

## Data Summary.
Get a rough idea about the data set. For further details, check documentation of the loaded dataset.
```{r features}
names(eaq_data) #Features of the data set
```
```{r snapshot}
head(eaq_data, 15) #snapshot of the dataset
```

## Creating a Timeline of Earthquakes
We will be using two sorts of timeline using **geom_timeline** and **geom_timteline_label** of ggplot. Both have similar construction except for the fact that the later can be used to annotate the points on the timeline.

```{r fig.height = 5, fig.width = 10}

library(magrittr)
library(ggplot2)

data <- eaq_data%>%
          eq_clean_data()%>%
          dplyr::filter(`Country` %in% c("MEXICO") & !(is.na(Mag))) 

ggplot(data = data, aes(x = Year, y = Country, size = Mag, colour = `Total Deaths`)) +
 geom_timeline(alpha = 0.3)
```

```{r fig.height = 5, fig.width = 10}

library(magrittr)

data <- eaq_data%>%
          eq_clean_data()%>%
          dplyr::filter(`Country` %in% c("MEXICO") & !(is.na(Mag))) 

ggplot(data = data, aes(x = Year, y = Country, size = Mag, colour = `Total Deaths`, label = `Location Name`)) + geom_timeline_label(alpha = 0.3)

```

## Mapping the Earthquake locations on a World Map
```{r fig.height=5, fig.width=10}

eaq_data%>%
  eq_clean_data()%>%
  dplyr::filter(`Country` == "MEXICO" & lubridate::year(Date) >= 2000) %>%
  dplyr::mutate(popup_text = eq_create_label(.)) %>%
  eq_map(annot_col = "popup_text")

```

```{r fig.height=5, fig.width=10}

eaq_data%>%
  eq_clean_data()%>%
  dplyr::filter(`Country` == "MEXICO" & lubridate::year(Date) >= 2000) %>%
  eq_map(annot_col = "Date")

```
